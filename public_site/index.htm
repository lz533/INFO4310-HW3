<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://d3js.org/topojson.v3.min.js"></script>
  <link
    href="https://fonts.googleapis.com/css?family=Aldrich|Arima+Madurai|Open Sans|Libre+Baskerville|Pirata+One|Poiret+One|Sancreek|Satisfy|Share+Tech+Mono|Smokum|Snowburst+One|Special+Elite"
    rel="stylesheet">

  <style>
    body {
      font: "Arima+Madurai";
    }
  </style>
</head>

<body>
  <h2 style="text-align: center;">Pittsburgh Homefinder for Foodies</h2>
  <h4 style="text-align: center;">Eric Freitag, Longyi Zhang, Lyon Li, Miles Rosenthal </h4>
  <div style="text-align: center;">
    <p style="margin-bottom: 50; text-align: left;">
    </p>

    <svg id="main" height=750 width=1200 style="margin-bottom: 50;"></svg>
  </div>

</body>

<script>
  let render = async function () {

    // TODO: Set up main visualization
    const main = d3.select("#main")
    const mainMargin = { t: 10, r: 10, b: 10, l: 10 }
    const mainWidth = main.attr("width") - mainMargin.l - mainMargin.r
    const mainHeight = main.attr("height") - mainMargin.t - mainMargin.b
    const viewport = main.append("g")
      .attr("transform", `translate(${mainMargin.l},${mainMargin.t})`)

    // TODO: Load and process datasets
    const zillow = await d3.csv('./zillow_pittsburgh.csv')
    const yelp = await d3.csv('./yelp_pittsburgh_restaurants.csv')
    
    const pittsburgh = await d3.json('./pittsburgh.json')
    console.log(pittsburgh)

    let projection = d3.geoEquirectangular().fitSize([mainWidth, mainHeight]);
    let geoGenerator = d3.geoPath().projection(projection);

    viewport.selectAll('path')
            .data(pittsburgh.features)
            .join('path')
            .attr('d', geoGenerator);
    

    // TODO: display nearby yelp data when a home is clicked, maybe zoom in?
    function selectHome(){
  
    }
    // TODO: clear map when clicking elsewhere
    function leaveHome(){
      
    }

    // TODO: update map 
    function updateMap(){

    }
    
  }
  render();
</script>

</html>